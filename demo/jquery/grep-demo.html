<!-- MOVED to new location demo/solr-search -->
<html ng-app="grepDemo">
  <head>
    <title>Demo jQuery grep</title>

    <link rel='stylesheet' href='/bower_components/bootstrap/dist/css/bootstrap.min.css'/>
    <link rel='stylesheet' href='/bower_components/font-awesome/css/font-awesome.css'/>

    <link rel='stylesheet' href='/bower_components/jquery-ui/themes/base/jquery-ui.css'/>
    <link rel='stylesheet' href='/bower_components/jquery-ui-bootstrap/jquery.ui.theme.css'/>

    <script src='/bower_components/jquery/dist/jquery.min.js'></script>
    <script src='/bower_components/jquery-ui/jquery-ui.min.js'></script>
    <script src='/bower_components/bootstrap/dist/js/bootstrap.min.js'></script>
    <script src='/bower_components/angular/angular.min.js'></script>

    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script src='https://cdn.rawgit.com/leocornus/leocornus-visualdata/v0.0.6/src/zoomable-circles.js'></script>

<style>
/**
 * styles needed for zoomable circles.
 */
.node {
    cursor: pointer;
}

.node:hover {
    stroke: #000;
    stroke-width: 1.5px;
}

.node--leaf {
    fill: grey;
}

.label {
    font: 16px "Helvetica Neue", Helvetica, Arial, sans-serif;
    text-anchor: middle;
    font-weight: bold;
    text-shadow: 0 1px 0 #fff, 1px 0 0 #fff, -1px 0 0 #fff, 0 -1px 0 #fff;
}

.label, .node--root, .node--leaf, use {
    pointer-events: none;
}

/**
 * for the input clear button.
 */
::-ms-clear {
  display: none;
}

.form-control-clear {
  z-index: 10;
  pointer-events: auto;
  cursor: pointer;
}
  </style>
    <script>
// this will replace the code in controller.js
var simpleTest = angular.module('grepDemo', []);

jQuery(document).ready(function($) {

    var intranets;
    var sizes;
    // using when to have multipile ajax call.
    $.when(
        // get the list name.
        $.ajax({
            type: "GET",
            url: 'data/intranet-path.json',
            dataType: "json",
            success: function(data) {
                console.log(data.length);
                intranets = data;
            }
        }),
        // load the size.
        $.ajax({
            type: "GET",
            url: 'data/intranet-size-2017.json',
            dataType: "json",
            success: function(data) {
                console.log(data.length);
                sizes = data;
            }
        })
    ).then(function() {

        //console.log(intranets);
        // append the size to intanets list.
        sizes.forEach(function(size) {
            var id = size[0];
            var theSize = size[1];
            // it will return -1, if no match found.
            var i = intranets.findIndex(function(one) {
                return one[0] === id;
            });
            if(i >= 0) intranets[i].push(theSize);
        });
        //console.log(intranets);
        var result = $("#result");
        result.html("");
        result.append('<div id="circles"></div>');

        // get ready the data.
        var circles =[];
        var color = d3.scale.linear().domain([0, intranets.length])
            .range(["blue", "yellow"])
            .interpolate(d3.interpolateHcl);
        for(i = 0; i < intranets.length; i++) {
            var site = intranets[i];
            var size = site[2];
            // set name to empty if size is too small
            // less than 200MB.
            var name = size > 2000000 ? site[1] : '';
            var circle = {
              "name": name,
              "children":[{
                  "name": site[1],
                  "size": site[2],
                  "leafFill": color(i),
                  "imgUrl": ""
              }]
            };
            circles.push(circle);
        }
        // get ready the json data for the zoomable circle.
        var jsonData = {
              "attributes": {
                "title": "3 Equal size circles",
                "description": "Data example to show the data structure",
                "colorRange": [
                  "white"
                ],
                "leafFill": "green"
              },
              "data": {
                "name":"This will NOT show anywhere!",
                "children": circles
              }
            };
        $('#circles').zoomableCircles({}, jsonData);
    });
});
    </script>

    <style>
    .list-group-item {
        border: 0px;
    }

    .panel-custom {
        border: 0px;
    }

    .panel-custom .panel-footer{
        background: #FFF;
    }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- page header -->
      <div class="page-header">
        <h1 class="">jQuery grep Demo Page</h1> 
      </div>

      <!-- Search bar -->
      <div class="container container-fluid bar-search bg-muted">
      <div class="row" id="search-bar">
        <div class="col-md-2">
        </div>

        <div class="col-md-8">
          <div class="input-group"
               role="group" aria-label="...">
            <input type="text" class="form-control"
                   placeholder="Find something"
                   id="search-input"
                   aria-describedby="sizing-addon"/>
            <span class="input-group-btn">
              <button class="btn btn-default"
                 type="button"
                 id="sizing-addon">
                <i class="fa fa-search text-primary"></i>
                Search
              </button>
            </span>
          </div>
        </div>

        <div class="col-md-2">
        </div>
      </div>
      <p></p>
      </div>

      <!-- search result -->
      <div class="container container-fluid bar-search bg-muted">
      <div class="row" id="search-result"> 

      <div class="col-md-8">
        <div class="panel panel-info panel-custom">
          <div class="panel-heading">
            Current Search:
          </div>

          <div class="panel-body" id="result">
            Sort by dropdown<br/>
            Page 4 of 345 Results
          </div>

          <div class="panel-footer panel-footer-custom">
           happy footer 
          </div>
        </div>
      </div> <!-- col-8 -->

      <div class="col-md-4">
        <div class="panel panel-success panel-custom">
          <div class="panel-heading">
            Search Filters
          </div>

          <div class="panel-body">
            LIST OF FILTERS.
            <p></p>
            In Tag Cloud
          </div>
      </div> <!-- col-4 -->

      </div> <!-- search result row -->
      </div>

    </div>
  </body>
</html>
